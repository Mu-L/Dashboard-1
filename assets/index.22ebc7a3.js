var te=Object.defineProperty;var $=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var N=(e,t,o)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,j=(e,t)=>{for(var o in t||(t={}))ne.call(t,o)&&N(e,o,t[o]);if($)for(var o of $(t))ae.call(t,o)&&N(e,o,t[o]);return e};import{_ as oe,d as ie,u as re,r as g,G as f,x as se,y as le,o as s,j as l,g as p,E as b,L as C,i as d,t as v,N as E,O as ce,h as w,b as T,z as I,P as pe,H as de,Q as ue,f as he,R as K,F as D,l as O,D as ge,U as be}from"./index.ffc16ffa.js";import{g as me}from"./images.c918f91a.js";const B=ie({name:"Search",props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const t=re(),o=g(0),x=g(!1),c=g(""),r=g([]),i=g(-1),a=g(!1),m=g(),y=f(()=>e.componentSetting.engineList[o.value]||e.componentSetting.engineList[0]);let k;const J=n=>{o.value=n,x.value=!1},S=()=>{e.componentSetting.rememberHistory&&Q(c.value);let n=y.value.link;/\[0\]/.test(n)?n=n.replace(/\[0\]/,encodeURIComponent(c.value)):n=n+encodeURIComponent(c.value),e.componentSetting.jumpType===2?window.location.href=n:window.open(n),c.value="",r.value=[],m.value.blur()},R=n=>{[9,13,38,40].includes(n.keyCode)?(n.keyCode===9&&(n.shiftKey?(o.value=o.value<=0?e.componentSetting.engineList.length-1:--o.value,n.preventDefault()):(o.value=o.value>=e.componentSetting.engineList.length-1?0:++o.value,n.preventDefault())),n.keyCode===13&&S(),n.keyCode===38&&(i.value=i.value<=0&&r.value.length>0?r.value.length-1:i.value-1,c.value=r.value[i.value]),n.keyCode===40&&(i.value=i.value<r.value.length-1&&r.value.length>0?i.value+1:0,c.value=r.value[i.value])):(k&&window.clearTimeout(k),k=window.setTimeout(()=>{A()},400))},L=f(()=>e.componentSetting.focusBgAnimation&&t.global.background.includes("url")),M=()=>{A(),e.componentSetting.showTabTips&&(!e.componentSetting.rememberHistory||e.componentSetting.rememberHistoryList.length===0)&&(a.value=!0),L.value&&t.updateState({key:"showBackgroundEffect",value:!0})},P=()=>{setTimeout(()=>{a.value=!1},200),r.value=[],L.value&&t.updateState({key:"showBackgroundEffect",value:!1})},W=()=>{a.value=!1;const n=JSON.parse(JSON.stringify(e.element));e.isAction?(n.actionSetting.actionClickValue.componentSetting.showTabTips=!1,t.updateActionElement(n)):n.componentSetting.showTabTips=!1,t.editComponent(n)},q=()=>{c.value=""},G=n=>{r.value=[],i.value=-1,c.value=n,setTimeout(()=>{S()},200)};async function A(){if(!c.value){e.componentSetting.rememberHistory?r.value=e.componentSetting.rememberHistoryList||[]:r.value=[],i.value=-1;return}if(!!e.componentSetting.keywordLink)try{const n=await fetch(`${pe}/getAutomatedKeywords?s=${c.value}`),{errCode:u,data:h}=await n.json();if(u===200)a.value=!1,c.value&&(r.value=h);else throw new Error("403")}catch{r.value=[],i.value=-1}}function Q(n){const u=JSON.parse(JSON.stringify(e.element)),h=u.componentSetting.rememberHistoryList||[];~h.indexOf(n)||(h.unshift(n),h.length>10&&(h.length=10),e.isAction?(u.actionSetting.actionClickValue.componentSetting.rememberHistoryList=h,t.updateActionElement(u)):u.componentSetting.rememberHistoryList=h,t.editComponent(u))}function X(){const n=JSON.parse(JSON.stringify(e.element));e.isAction?(n.actionSetting.actionClickValue.componentSetting.rememberHistoryList=[],t.updateActionElement(n)):n.componentSetting.rememberHistoryList=[],t.editComponent(n)}const z=g();function H(n){x.value&&!z.value.contains(n.target)&&(x.value=!1)}se(()=>{a.value=e.element.showTabTips,document.addEventListener("click",H)}),le(()=>{document.removeEventListener("click",H)});const Y=f(()=>de(e.componentSetting.position)),F=f(()=>t.isLock),Z=n=>{F.value&&n.stopPropagation()},_=f(()=>e.componentSetting.boxBackground||"rgba(255,255,255,0.9)"),ee=f(()=>e.componentSetting.textColor||"#464650");return{activeEngine:o,showEngine:x,searchKey:c,linkSearchArr:r,linkSearchArrActive:i,showTabTips:a,activeEngineItem:y,handleChangeEngine:J,handleInputKeyDown:R,handleInputFocus:M,handleInputBlur:P,hanldeNoShowMore:W,handleClear:q,handleLinkSearchJump:G,handleSearchBtnClick:S,searchInput:m,engineSelector:z,positionCSS:Y,getTargetIcon:me,clearHistory:X,contextmenu:Z,isLock:F,boxBackground:_,textColor:ee}}}),V=()=>{ue(e=>({"0797283a":e.boxBackground,caa97c80:e.textColor}))},U=B.setup;B.setup=U?(e,t)=>(V(),U(e,t)):V;const ve=B,fe=["src"],we=["src"],xe={key:2,class:"no-icon"},ye={class:"search-input-box-wrapper"},ke=["onClick"],Se=["src"],Ce=["src"],Ee={key:2,class:"no-icon"},Te={class:"text"},Ie=["onClick"],Be={key:0,class:"clear-history"},Le={class:"tab-tooltips"},Ae={class:"main"};function ze(e,t,o,x,c,r){const i=he("Icon");return s(),l("div",{class:"wrapper",style:b(j({padding:e.componentSetting.padding+"px"},e.positionCSS))},[p("div",{class:"search-wrapper-box",style:b({maxWidth:`${e.componentSetting.maxWidth||600}px`,pointerEvents:e.isLock?"all":"none"}),onContextmenu:t[9]||(t[9]=(...a)=>e.contextmenu&&e.contextmenu(...a))},[p("div",{class:"search-main-box",style:b({boxShadow:e.componentSetting.boxShadow,borderRadius:`${e.componentSetting.boxRadius||4}px`,padding:`0 ${(e.componentSetting.boxRadius||4)/4}px`,backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none"})},[p("div",{class:"search-engine-box",style:b({filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:t[0]||(t[0]=C(a=>e.showEngine=!e.showEngine,["stop"]))},[e.activeEngineItem.iconType==="local"||e.activeEngineItem.iconType==="network"?(s(),l("img",{key:0,src:e.activeEngineItem.iconPath,alt:"icon",width:"24",height:"24"},null,8,fe)):d("",!0),e.activeEngineItem.iconType==="api"?(s(),l("img",{key:1,src:e.getTargetIcon(e.activeEngineItem.link),alt:"icon",width:"24",height:"24"},null,8,we)):d("",!0),e.activeEngineItem.iconType==="text"?(s(),l("div",xe,v(e.activeEngineItem.name.slice(0,1)),1)):d("",!0)],4),p("div",ye,[E(p("input",{class:"search-input-box",style:b({color:e.componentSetting.textColor}),ref:"searchInput","onUpdate:modelValue":t[1]||(t[1]=a=>e.searchKey=a),onKeydown:t[2]||(t[2]=C((...a)=>e.handleInputKeyDown&&e.handleInputKeyDown(...a),["stop"])),onFocus:t[3]||(t[3]=(...a)=>e.handleInputFocus&&e.handleInputFocus(...a)),onBlur:t[4]||(t[4]=(...a)=>e.handleInputBlur&&e.handleInputBlur(...a)),tabindex:"1"},null,36),[[ce,e.searchKey]]),e.searchKey?(s(),l("div",{key:0,class:"clear-btn",onClick:t[5]||(t[5]=(...a)=>e.handleClear&&e.handleClear(...a))},[w(i,{name:"close"})])):d("",!0)]),p("div",{class:"search-btn",style:b({color:e.componentSetting.textColor,filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:t[6]||(t[6]=(...a)=>e.handleSearchBtnClick&&e.handleSearchBtnClick(...a))},[w(i,{name:"search"})],4)],4),w(I,{name:"fadeInUp"},{default:T(()=>[E(p("div",{ref:"engineSelector",class:"engine-selector",style:b({backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none",filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"})},[(s(!0),l(D,null,O(e.componentSetting.engineList,(a,m)=>(s(),l("div",{key:m,class:"engine-list-item",onClick:y=>e.handleChangeEngine(m)},[a.iconType==="local"||a.iconType==="network"?(s(),l("img",{key:0,src:a.iconPath,alt:"icon",width:"24",height:"24"},null,8,Se)):d("",!0),a.iconType==="api"?(s(),l("img",{key:1,src:e.getTargetIcon(a.link),alt:"icon",width:"24",height:"24"},null,8,Ce)):d("",!0),a.iconType==="text"?(s(),l("div",Ee,v(a.name.slice(0,1)),1)):d("",!0),p("div",Te,v(a.name),1)],8,ke))),128))],4),[[K,e.showEngine]])]),_:1}),w(I,{name:"fadeInUp"},{default:T(()=>[e.linkSearchArr.length>0?(s(),l("div",{key:0,class:"link-search-wrapper",style:b({backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none"})},[(s(!0),l(D,null,O(e.linkSearchArr,(a,m)=>(s(),l("div",{class:ge(["link-search-item",{active:e.linkSearchArrActive===m}]),key:a,onClick:y=>e.handleLinkSearchJump(a)},v(a),11,Ie))),128)),!e.searchKey&&e.componentSetting.rememberHistory?(s(),l("div",Be,[p("div",{class:"clear-history-btn",onClick:t[7]||(t[7]=(...a)=>e.clearHistory&&e.clearHistory(...a))},[w(i,{name:"delete",size:"1em",style:{"margin-right":"2px"}}),be(" "+v(e.$t("\u6E05\u7A7A\u5386\u53F2\u8BB0\u5F55")),1)])])):d("",!0)],4)):d("",!0)]),_:1}),w(I,{name:"fadeInUp"},{default:T(()=>[E(p("div",Le,[p("div",Ae,v(e.$t("\u6309Tab\u952E\u53EF\u5FEB\u901F\u5207\u6362\u641C\u7D22\u5F15\u64CE")),1),p("div",{class:"no-more",onClick:t[8]||(t[8]=C((...a)=>e.hanldeNoShowMore&&e.hanldeNoShowMore(...a),["stop"]))},v(e.$t("\u4E0D\u518D\u63D0\u793A")),1)],512),[[K,e.showTabTips]])]),_:1})],36)],4)}var je=oe(ve,[["render",ze],["__scopeId","data-v-69a17b46"]]);export{je as default};
