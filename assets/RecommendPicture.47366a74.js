import{_ as U,d as H,r as o,w as O,o as t,j as a,g as s,t as h,h as q,b as M,F as p,f as T,D as x,N as y,R as k,l as v,i as C,P as $}from"./index.87588bc9.js";const G={key:0,class:"wrapper"},K={class:"tab-title-wrapper"},J={class:"tab-container"},Q={key:0,class:"text"},W={key:1,class:"text"},X={key:2,class:"item-wrapper"},Y=["onClick"],Z={class:"img-wrapper"},ee=["src"],te={class:"tab-container"},ae={key:0,class:"text"},se={key:1,class:"text"},re={key:2,class:"item-wrapper"},ie=["onClick"],le={class:"img-wrapper"},ne=["src"],oe={class:"sub-tab-container"},ue=["onClick"],ce={class:"tab-container"},pe={class:"item-wrapper"},de=["onClick"],ve={class:"img-wrapper"},he=["src"],me={class:"load-more"},fe=["loading"],ge=H({__name:"RecommendPicture",emits:["submit"],setup(be,{emit:P}){const m=o(!1),f=o(!1),l=o(1),n=o(!1),u=o(!1),g=o([]),b=o([]),w=o([]),E=o(1),B=[{label:"\u98CE\u666F",value:9},{label:"4K",value:36},{label:"\u6E05\u65B0",value:15},{label:"\u840C\u5BA0",value:14},{label:"\u6E38\u620F",value:5},{label:"\u6C7D\u8F66",value:12},{label:"\u65F6\u5C1A",value:10},{label:"\u4F53\u80B2",value:16}],_=o(9),N=async()=>{try{n.value=!0,u.value=!1;const r=encodeURIComponent("https://cn.bing.com/HPImageArchive.aspx?format=js&idx=0&n=8&mkt=zh-CN"),i=await fetch(`${$}/api/transfer?target=${r}&noHeaders=1`,{headers:{"content-type":"application/json; charset=utf-8"}}),{images:d}=await i.json(),e=encodeURIComponent("https://cn.bing.com/HPImageArchive.aspx?format=js&idx=8&n=8&mkt=zh-CN"),c=await fetch(`${$}/api/transfer?target=${e}&noHeaders=1`,{headers:{"content-type":"application/json; charset=utf-8"}}),{images:A}=await c.json();A.shift();const D=[...d,...A];g.value=D.map(j=>{const I=`https://cn.bing.com/${j.url}`,V=`https://cn.bing.com/${j.urlbase}_320x240.jpg&rf=LaDigue_1920x1080.jpg&pid=hp`;return{url:I,thumb:V}})}catch(r){u.value=!0,console.error(r)}finally{n.value=!1}},S=async()=>{try{n.value=!0,u.value=!1;const r=await fetch(`${$}/photos?pageSize=18`),{errCode:i,data:d}=await r.json();if(i===200)b.value=d.list.map(e=>({url:e.urls.raw,thumb:e.urls.thumb}));else throw new Error("Api server error")}catch(r){u.value=!0,console.error(r)}finally{n.value=!1}},z=async(r=!1)=>{r&&(w.value=[],E.value=1);try{n.value=!0,u.value=!1;const i=await fetch(`${$}/api/360img?cid=${_.value}&page=${E.value}&pageSize=18`),{errno:d,data:e}=await i.json();if(d===0)w.value=[...w.value,...e.list.map(c=>({url:c.url.replace("http","https"),thumb:`${c.url.replace("http","https")}?x-oss-process=image/resize,w_300/quality,q_90`}))];else throw new Error("Api server error")}catch(i){u.value=!0,console.error(i)}finally{n.value=!1}},F=()=>{f.value=!0,m.value||(m.value=!0)};O(()=>[m.value,l.value,_.value],()=>{l.value===1?(!g.value||g.value.length===0)&&N():l.value===2?(!b.value||b.value.length===0)&&S():l.value===3&&z(!0)});const R=()=>{E.value++,z()},L=r=>{P("submit",r),f.value=!1};return(r,i)=>{const d=T("easy-dialog");return t(),a(p,null,[s("button",{type:"button",class:"btn btn-small btn-primary",style:{margin:"0","margin-right":"5px"},onClick:F},h(r.$t("\u4ECA\u65E5\u58C1\u7EB8\u63A8\u8350")),1),q(d,{modelValue:f.value,"onUpdate:modelValue":i[3]||(i[3]=e=>f.value=e),title:r.$t("\u4ECA\u65E5\u58C1\u7EB8\u63A8\u8350"),width:"min(760px, 94vw)",height:"min(560px, 80vh)"},{default:M(()=>[m.value?(t(),a("div",G,[s("div",K,[s("div",{class:x(["title",l.value===1&&"active"]),onClick:i[0]||(i[0]=e=>l.value=1)},h(r.$t("\u5FC5\u5E94\u58C1\u7EB8")),3),s("div",{class:x(["title",l.value===3&&"active"]),onClick:i[1]||(i[1]=e=>l.value=3)},h(r.$t("360\u58C1\u7EB8")),3),s("div",{class:x(["title",l.value===2&&"active"]),onClick:i[2]||(i[2]=e=>l.value=2)},"UNSPLAH",2)]),y(s("div",J,[n.value?(t(),a("div",Q,"Loading...")):u.value?(t(),a("div",W,"Something Error...")):(t(),a("div",X,[(t(!0),a(p,null,v(g.value,e=>(t(),a("div",{class:"item",key:e.url,onClick:c=>L(e.url)},[s("div",Z,[e.url?(t(),a("img",{key:0,src:e.thumb,loading:"lazy"},null,8,ee)):C("",!0)])],8,Y))),128)),(t(),a(p,null,v(4,e=>s("div",{class:"item-fake",key:e})),64))]))],512),[[k,l.value===1]]),y(s("div",te,[n.value?(t(),a("div",ae,"Loading...")):u.value?(t(),a("div",se,"Something Error...")):(t(),a("div",re,[(t(!0),a(p,null,v(b.value,e=>(t(),a("div",{class:"item",key:e.url,onClick:c=>L(e.url)},[s("div",le,[e.url?(t(),a("img",{key:0,src:e.thumb,loading:"lazy"},null,8,ne)):C("",!0)])],8,ie))),128)),(t(),a(p,null,v(4,e=>s("div",{class:"item-fake",key:e})),64))]))],512),[[k,l.value===2]]),y(s("div",oe,[(t(),a(p,null,v(B,e=>s("div",{class:x(["sub-tab-title",_.value===e.value&&"active"]),key:e.value,onClick:c=>_.value=e.value},h(r.$t(e.label)),11,ue)),64))],512),[[k,l.value===3]]),y(s("div",ce,[s("div",pe,[(t(!0),a(p,null,v(w.value,e=>(t(),a("div",{class:"item",key:e.url,onClick:c=>L(e.url)},[s("div",ve,[e.url?(t(),a("img",{key:0,src:e.thumb,loading:"lazy"},null,8,he)):C("",!0)])],8,de))),128)),(t(),a(p,null,v(4,e=>s("div",{class:"item-fake",key:e})),64))]),s("div",me,[s("button",{class:"btn btn-warning",loading:n.value,onClick:R},h(n.value?"LOADING...":"LOAD MORE"),9,fe)])],512),[[k,l.value===3]])])):C("",!0)]),_:1},8,["modelValue","title"])],64)}}});var _e=U(ge,[["__scopeId","data-v-278833f9"]]);export{_e as default};
