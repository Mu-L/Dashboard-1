import{_ as Z,d as _,u as ee,r as g,G as f,x as te,y as ne,o as r,j as s,g as c,E as b,L as C,i as d,t as v,N as E,O as ae,h as w,b as T,z as I,P as oe,H as ie,Q as re,f as se,R as $,F as N,l as j,D as le,U as ce}from"./index.87588bc9.js";import{g as pe}from"./images.4ec01e13.js";const B=_({name:"Search",props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const a=ee(),p=g(0),x=g(!1),l=g(""),i=g([]),o=g(-1),n=g(!1),m=g(),y=f(()=>e.componentSetting.engineList[p.value]||e.componentSetting.engineList[0]);let k;const O=t=>{p.value=t,x.value=!1},S=()=>{e.componentSetting.rememberHistory&&W(l.value);let t=y.value.link;/\[0\]/.test(t)?t=t.replace(/\[0\]/,encodeURIComponent(l.value)):t=t+encodeURIComponent(l.value),e.componentSetting.jumpType===2?window.location.href=t:window.open(t),l.value="",i.value=[],m.value.blur()},V=t=>{[9,13,38,40].includes(t.keyCode)?(t.keyCode===9&&(t.shiftKey?(p.value=p.value<=0?e.componentSetting.engineList.length-1:--p.value,t.preventDefault()):(p.value=p.value>=e.componentSetting.engineList.length-1?0:++p.value,t.preventDefault())),t.keyCode===13&&S(),t.keyCode===38&&(o.value=o.value<=0&&i.value.length>0?i.value.length-1:o.value-1,l.value=i.value[o.value]),t.keyCode===40&&(o.value=o.value<i.value.length-1&&i.value.length>0?o.value+1:0,l.value=i.value[o.value])):(k&&window.clearTimeout(k),k=window.setTimeout(()=>{A()},400))},L=f(()=>e.componentSetting.focusBgAnimation&&a.global.background.includes("url")),U=()=>{A(),e.componentSetting.showTabTips&&(!e.componentSetting.rememberHistory||e.componentSetting.rememberHistoryList.length===0)&&(n.value=!0),L.value&&a.updateState({key:"showBackgroundEffect",value:!0})},J=()=>{setTimeout(()=>{n.value=!1},200),i.value=[],L.value&&a.updateState({key:"showBackgroundEffect",value:!1})},R=()=>{n.value=!1;const t=JSON.parse(JSON.stringify(e.element));e.isAction?(t.actionSetting.actionClickValue.componentSetting.showTabTips=!1,a.updateActionElement(t)):t.componentSetting.showTabTips=!1,a.editComponent(t)},M=()=>{l.value=""},P=t=>{i.value=[],o.value=-1,l.value=t,setTimeout(()=>{S()},200)};async function A(){if(!l.value){e.componentSetting.rememberHistory?i.value=e.componentSetting.rememberHistoryList||[]:i.value=[],o.value=-1;return}if(!!e.componentSetting.keywordLink)try{const t=await fetch(`${oe}/getAutomatedKeywords?s=${l.value}`),{errCode:u,data:h}=await t.json();if(u===200)n.value=!1,l.value&&(i.value=h);else throw new Error("403")}catch{i.value=[],o.value=-1}}function W(t){const u=JSON.parse(JSON.stringify(e.element)),h=u.componentSetting.rememberHistoryList||[];~h.indexOf(t)||(h.unshift(t),h.length>10&&(h.length=10),e.isAction?(u.actionSetting.actionClickValue.componentSetting.rememberHistoryList=h,a.updateActionElement(u)):u.componentSetting.rememberHistoryList=h,a.editComponent(u))}function q(){const t=JSON.parse(JSON.stringify(e.element));e.isAction?(t.actionSetting.actionClickValue.componentSetting.rememberHistoryList=[],a.updateActionElement(t)):t.componentSetting.rememberHistoryList=[],a.editComponent(t)}const z=g();function H(t){x.value&&!z.value.contains(t.target)&&(x.value=!1)}te(()=>{n.value=e.element.showTabTips,document.addEventListener("click",H)}),ne(()=>{document.removeEventListener("click",H)});const G=f(()=>ie(e.componentSetting.position)),F=f(()=>a.isLock),Q=t=>{F.value&&t.stopPropagation()},X=f(()=>e.componentSetting.boxBackground||"rgba(255,255,255,0.9)"),Y=f(()=>e.componentSetting.textColor||"#464650");return{activeEngine:p,showEngine:x,searchKey:l,linkSearchArr:i,linkSearchArrActive:o,showTabTips:n,activeEngineItem:y,handleChangeEngine:O,handleInputKeyDown:V,handleInputFocus:U,handleInputBlur:J,hanldeNoShowMore:R,handleClear:M,handleLinkSearchJump:P,handleSearchBtnClick:S,searchInput:m,engineSelector:z,positionCSS:G,getTargetIcon:pe,clearHistory:q,contextmenu:Q,isLock:F,boxBackground:X,textColor:Y}}}),K=()=>{re(e=>({"0797283a":e.boxBackground,caa97c80:e.textColor}))},D=B.setup;B.setup=D?(e,a)=>(K(),D(e,a)):K;const de=B,ue=["src"],he=["src"],ge={key:2,class:"no-icon"},be={class:"search-input-box-wrapper"},me=["onClick"],ve=["src"],fe=["src"],we={key:2,class:"no-icon"},xe={class:"text"},ye=["onClick"],ke={key:0,class:"clear-history"},Se={class:"tab-tooltips"},Ce={class:"main"};function Ee(e,a,p,x,l,i){const o=se("Icon");return r(),s("div",{class:"wrapper",style:b({padding:e.componentSetting.padding+"px",...e.positionCSS})},[c("div",{class:"search-wrapper-box",style:b({maxWidth:`${e.componentSetting.maxWidth||600}px`,pointerEvents:e.isLock?"all":"none"}),onContextmenu:a[9]||(a[9]=(...n)=>e.contextmenu&&e.contextmenu(...n))},[c("div",{class:"search-main-box",style:b({boxShadow:e.componentSetting.boxShadow,borderRadius:`${e.componentSetting.boxRadius||4}px`,padding:`0 ${(e.componentSetting.boxRadius||4)/4}px`,backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none"})},[c("div",{class:"search-engine-box",style:b({filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:a[0]||(a[0]=C(n=>e.showEngine=!e.showEngine,["stop"]))},[e.activeEngineItem.iconType==="local"||e.activeEngineItem.iconType==="network"?(r(),s("img",{key:0,src:e.activeEngineItem.iconPath,alt:"icon",width:"24",height:"24"},null,8,ue)):d("",!0),e.activeEngineItem.iconType==="api"?(r(),s("img",{key:1,src:e.getTargetIcon(e.activeEngineItem.link),alt:"icon",width:"24",height:"24"},null,8,he)):d("",!0),e.activeEngineItem.iconType==="text"?(r(),s("div",ge,v(e.activeEngineItem.name.slice(0,1)),1)):d("",!0)],4),c("div",be,[E(c("input",{class:"search-input-box",style:b({color:e.componentSetting.textColor}),ref:"searchInput","onUpdate:modelValue":a[1]||(a[1]=n=>e.searchKey=n),onKeydown:a[2]||(a[2]=C((...n)=>e.handleInputKeyDown&&e.handleInputKeyDown(...n),["stop"])),onFocus:a[3]||(a[3]=(...n)=>e.handleInputFocus&&e.handleInputFocus(...n)),onBlur:a[4]||(a[4]=(...n)=>e.handleInputBlur&&e.handleInputBlur(...n)),tabindex:"1"},null,36),[[ae,e.searchKey]]),e.searchKey?(r(),s("div",{key:0,class:"clear-btn",onClick:a[5]||(a[5]=(...n)=>e.handleClear&&e.handleClear(...n))},[w(o,{name:"close"})])):d("",!0)]),c("div",{class:"search-btn",style:b({color:e.componentSetting.textColor,filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"}),onClick:a[6]||(a[6]=(...n)=>e.handleSearchBtnClick&&e.handleSearchBtnClick(...n))},[w(o,{name:"search"})],4)],4),w(I,{name:"fadeInUp"},{default:T(()=>[E(c("div",{ref:"engineSelector",class:"engine-selector",style:b({backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none",filter:e.componentSetting.backdropBlur?"drop-shadow(1px 2px 4px #262626)":"none"})},[(r(!0),s(N,null,j(e.componentSetting.engineList,(n,m)=>(r(),s("div",{key:m,class:"engine-list-item",onClick:y=>e.handleChangeEngine(m)},[n.iconType==="local"||n.iconType==="network"?(r(),s("img",{key:0,src:n.iconPath,alt:"icon",width:"24",height:"24"},null,8,ve)):d("",!0),n.iconType==="api"?(r(),s("img",{key:1,src:e.getTargetIcon(n.link),alt:"icon",width:"24",height:"24"},null,8,fe)):d("",!0),n.iconType==="text"?(r(),s("div",we,v(n.name.slice(0,1)),1)):d("",!0),c("div",xe,v(n.name),1)],8,me))),128))],4),[[$,e.showEngine]])]),_:1}),w(I,{name:"fadeInUp"},{default:T(()=>[e.linkSearchArr.length>0?(r(),s("div",{key:0,class:"link-search-wrapper",style:b({backdropFilter:e.componentSetting.backdropBlur?"blur(5px)":"none"})},[(r(!0),s(N,null,j(e.linkSearchArr,(n,m)=>(r(),s("div",{class:le(["link-search-item",{active:e.linkSearchArrActive===m}]),key:n,onClick:y=>e.handleLinkSearchJump(n)},v(n),11,ye))),128)),!e.searchKey&&e.componentSetting.rememberHistory?(r(),s("div",ke,[c("div",{class:"clear-history-btn",onClick:a[7]||(a[7]=(...n)=>e.clearHistory&&e.clearHistory(...n))},[w(o,{name:"delete",size:"1em",style:{"margin-right":"2px"}}),ce(" "+v(e.$t("\u6E05\u7A7A\u5386\u53F2\u8BB0\u5F55")),1)])])):d("",!0)],4)):d("",!0)]),_:1}),w(I,{name:"fadeInUp"},{default:T(()=>[E(c("div",Se,[c("div",Ce,v(e.$t("\u6309Tab\u952E\u53EF\u5FEB\u901F\u5207\u6362\u641C\u7D22\u5F15\u64CE")),1),c("div",{class:"no-more",onClick:a[8]||(a[8]=C((...n)=>e.hanldeNoShowMore&&e.hanldeNoShowMore(...n),["stop"]))},v(e.$t("\u4E0D\u518D\u63D0\u793A")),1)],512),[[$,e.showTabTips]])]),_:1})],36)],4)}var Le=Z(de,[["render",Ee],["__scopeId","data-v-69a17b46"]]);export{Le as default};
