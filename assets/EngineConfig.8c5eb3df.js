import{D as S}from"./vuedraggable.umd.59f0d29a.js";import{g as P}from"./images.4ec01e13.js";import{_ as j,d as q,T as R,r as y,I as J,x as O,a as X,G as Y,o as l,j as u,g as a,t as s,h as r,b as d,i as c,F as $,a0 as G,P as M,s as x,a3 as H,f as h,U as _,l as K,c as A,p as Q,q as W}from"./index.87588bc9.js";const Z=[{label:"API\u83B7\u53D6",value:"api"},{label:"\u6587\u5B57\u56FE\u6807",value:"text"},{label:"\u7F51\u7EDC\u56FE\u7247",value:"network"}],ee=q({name:"EngineConfig",components:{Draggable:S,Tips:R},props:{engineList:{type:Array,required:!0},backupEngineList:{type:Array,required:!0}},emits:["update"],setup(e,{emit:n}){const V=y(!1),w=y(!1),g=y([]),E=y([]),D=y(""),f=y(!1),{t:v}=J();O(()=>{g.value=JSON.parse(JSON.stringify(e.engineList)),E.value=JSON.parse(JSON.stringify(e.backupEngineList))});const T=m=>{const{oldIndex:p}=m,{iconType:i}=g.value[p];i!=="local"&&(w.value=!0)},C=async()=>{await G(),w.value=!1},F=m=>{const{originalEvent:p}=m;let i;if(p.type==="touchend"){const{clientX:b,clientY:k}=p.changedTouches[0];i=document.elementFromPoint(b,k)}else{const{clientX:b,clientY:k}=p;i=document.elementFromPoint(b,k)}if((i==null?void 0:i.className)==="delete-area"&&window.confirm(v("\u662F\u5426\u5220\u9664\u8BE5\u81EA\u5B9A\u4E49\u5F15\u64CE"))){const{newIndex:b}=m;g.value.splice(b,1)}n("update",{engineList:g.value,backupEngineList:E.value})},o=X({formData:{_id:"",name:"",link:"",iconType:"api",iconPath:""},formRules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u5F15\u64CE\u540D\u79F0",trigger:"blur"}],link:[{required:!0,message:"\u8BF7\u8F93\u5165\u5F15\u64CE\u5730\u5740",trigger:"blur"}],iconType:[{required:!0,message:"\u8BF7\u9009\u62E9\u56FE\u6807\u7C7B\u578B",trigger:"change"}],iconPath:[{validator:B,trigger:"blur"}]}});function B(m,p,i){o.formData.iconType==="network"&&!p?i(new Error("\u8BF7\u8F93\u5165\u56FE\u6807\u5730\u5740")):i()}const t=y(),L=Y(()=>o.formData.iconType==="api"&&o.formData.link||o.formData.iconType==="network"&&o.formData.iconPath||o.formData.iconType==="text"&&o.formData.name),N=()=>{o.formData={_id:"",name:"",link:"",iconType:"api",iconPath:""},f.value=!0},I=()=>{t.value.resetFields(),o.formData={_id:"",name:"",link:"",iconType:"api",iconPath:""},f.value=!1};return{engineDialogVisible:f,dragDisabled:V,showDeleteArea:w,cloneEngineList:g,cloneBackupEngineList:E,handleDragChoose:T,handleDragUnchoose:C,handleDragEnd:F,handleAddNewEngine:N,handleEditEngine:m=>{const{_id:p,name:i,link:b,iconType:k,iconPath:z}=m;k!=="local"&&(o.formData={_id:p,name:i,link:b,iconType:k,iconPath:z},f.value=!0)},iconTypeList:Z,state:o,form:t,showIconPreview:L,close:I,submit:()=>{t.value.validate(async m=>{if(m){if(o.formData.iconType==="api"&&D.value)try{const i=await(await fetch(`${M}/api/icon?url=${encodeURIComponent(o.formData.link)}&type=link`)).text();i&&(o.formData.iconType="network",o.formData.iconPath=i)}catch{}if(o.formData._id){const p=g.value.findIndex(i=>i._id===o.formData._id);~p&&(g.value[p]={...x(o.formData)})}else o.formData._id=H(),g.value.push({...x(o.formData)});n("update",{engineList:g.value,backupEngineList:E.value}),I()}else return!1})},getTargetIcon:P,tempIconLink:D,handleLinkInputBlur:()=>{D.value=P(o.formData.link)}}}}),U=e=>(Q("data-v-20649a42"),e=e(),W(),e),te={class:"engine-config",style:{"margin-left":"-100px","padding-bottom":"10px","border-bottom":"1px solid #ccc"}},ne={class:"warning"},oe={class:"content"},ae={class:"text s-title"},ie={class:"current-engine-wrapper"},le=["onDblclick","title"],se=["src"],ue=["src"],re={key:2,class:"no-icon"},de={class:"text"},pe={class:"text s-title"},ce={class:"backup-engine-wrapper"},ge={class:"engine-list-item"},me=["src"],fe=["src"],he={key:2,class:"no-icon"},ve={class:"text"},be={key:0,class:"delete-area"},ye={class:"form-control"},De={class:"tips"},ke=U(()=>a("b",null,"[0]",-1)),Ee={class:"tips"},we=U(()=>a("b",null,"https://juejin.im/search?query=[0]&type=all",-1)),Fe={class:"icon-img-preview-box"},_e=["src"],Te=["src"],Ce={key:2,class:"no-icon"},Be={key:1,class:"icon-img-preview"},$e={class:"footer",style:{"text-align":"right",padding:"12px"}};function Ve(e,n,V,w,g,E){const D=h("Draggable"),f=h("el-input"),v=h("el-form-item"),T=h("Tips"),C=h("el-radio"),F=h("el-radio-group"),o=h("el-form"),B=h("easy-dialog");return l(),u($,null,[a("div",te,[a("div",ne,s(e.$t("searchConfigTips")),1),a("div",oe,[a("button",{type:"button",class:"btn btn-primary btn-small btn-add",onClick:n[0]||(n[0]=(...t)=>e.handleAddNewEngine&&e.handleAddNewEngine(...t))},s(e.$t("\u6DFB\u52A0")),1),a("div",ae,s(e.$t("\u5F53\u524D\u5F15\u64CE\u7EC4")),1),a("div",ie,[r(D,{modelValue:e.cloneEngineList,"onUpdate:modelValue":n[1]||(n[1]=t=>e.cloneEngineList=t),class:"now-engine-list engine-list","item-key":"name",group:"people",onChoose:e.handleDragChoose,onUnchoose:e.handleDragUnchoose,onEnd:e.handleDragEnd},{item:d(({element:t})=>[a("div",{class:"engine-list-item",onDblclick:L=>e.handleEditEngine(t),title:t.iconType!=="local"?e.$t("\u53CC\u51FB\u91CD\u65B0\u7F16\u8F91"):""},[t.iconType==="local"||t.iconType==="network"?(l(),u("img",{key:0,src:t.iconPath,alt:"icon",width:"24",height:"24"},null,8,se)):c("",!0),t.iconType==="api"?(l(),u("img",{key:1,src:e.getTargetIcon(t.link),alt:"icon",width:"24",height:"24"},null,8,ue)):c("",!0),t.iconType==="text"?(l(),u("div",re,s(t.name.slice(0,1)),1)):c("",!0),a("div",de,s(t.name),1)],40,le)]),_:1},8,["modelValue","onChoose","onUnchoose","onEnd"])]),a("div",pe,s(e.$t("\u5907\u7528\u5F15\u64CE\u7EC4")),1),a("div",ce,[r(D,{modelValue:e.cloneBackupEngineList,"onUpdate:modelValue":n[2]||(n[2]=t=>e.cloneBackupEngineList=t),"item-key":"name",group:"people",class:"backupEngineList engine-list",onEnd:e.handleDragEnd},{item:d(({element:t})=>[a("div",ge,[t.iconType==="local"||t.iconType==="network"?(l(),u("img",{key:0,src:t.iconPath,alt:"icon",width:"24",height:"24"},null,8,me)):c("",!0),t.iconType==="api"?(l(),u("img",{key:1,src:e.getTargetIcon(t.link),alt:"icon",width:"24",height:"24"},null,8,fe)):c("",!0),t.iconType==="text"?(l(),u("div",he,s(t.name.slice(0,1)),1)):c("",!0),a("div",ve,s(t.name),1)])]),_:1},8,["modelValue","onEnd"]),e.showDeleteArea?(l(),u("div",be,s(e.$t("\u62D6\u62FD\u81F3\u6B64\u5904\u5220\u9664")),1)):c("",!0)])])]),r(B,{modelValue:e.engineDialogVisible,"onUpdate:modelValue":n[10]||(n[10]=t=>e.engineDialogVisible=t),title:`${e.state.formData._id?e.$t("\u7F16\u8F91"):e.$t("\u6DFB\u52A0")}${e.$t("\u81EA\u5B9A\u4E49\u5F15\u64CE")}`,width:"min(380px, 90vw)",height:"min(460px, 80vh)",customClass:"add-engine-dialog"},{footer:d(()=>[a("div",$e,[a("button",{type:"button",class:"btn",onClick:n[8]||(n[8]=(...t)=>e.close&&e.close(...t))},s(e.$t("\u53D6\u6D88")),1),a("button",{type:"button",class:"btn btn-primary",onClick:n[9]||(n[9]=(...t)=>e.submit&&e.submit(...t))},s(e.$t("\u786E\u8BA4")),1)])]),default:d(()=>[r(o,{ref:"form","label-width":"90px",model:e.state.formData,rules:e.state.formRules},{default:d(()=>[r(v,{label:e.$t("\u5F15\u64CE\u540D\u79F0"),prop:"name"},{default:d(()=>[r(f,{modelValue:e.state.formData.name,"onUpdate:modelValue":n[3]||(n[3]=t=>e.state.formData.name=t),placeholder:e.$t("\u8BF7\u8F93\u5165\u5F15\u64CE\u540D\u79F0")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(v,{label:e.$t("\u5F15\u64CE\u5730\u5740"),prop:"link"},{default:d(()=>[a("div",ye,[r(f,{modelValue:e.state.formData.link,"onUpdate:modelValue":n[4]||(n[4]=t=>e.state.formData.link=t),placeholder:e.$t("\u8BF7\u8F93\u5165\u5F15\u64CE\u5730\u5740"),onBlur:e.handleLinkInputBlur},null,8,["modelValue","placeholder","onBlur"]),r(T,null,{default:d(()=>[a("div",De,[_(s(e.$t("engineConfigTips1"))+" ",1),ke,_(" "+s(e.$t("engineConfigTips2")),1)]),a("div",Ee,[_(s(e.$t("\u4F8B\u5982"))+": ",1),we])]),_:1})])]),_:1},8,["label"]),r(v,{label:e.$t("\u5F15\u64CE\u56FE\u6807"),prop:"iconType"},{default:d(()=>[r(F,{modelValue:e.state.formData.iconType,"onUpdate:modelValue":n[5]||(n[5]=t=>e.state.formData.iconType=t)},{default:d(()=>[(l(!0),u($,null,K(e.iconTypeList,t=>(l(),A(C,{label:t.value,key:t.value},{default:d(()=>[_(s(e.$t(t.label)),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e.state.formData.iconType==="network"?(l(),A(v,{key:0,label:e.$t("\u56FE\u6807\u5730\u5740"),prop:"iconPath"},{default:d(()=>[r(F,{modelValue:e.state.formData.iconType,"onUpdate:modelValue":n[7]||(n[7]=t=>e.state.formData.iconType=t)},{default:d(()=>[r(f,{modelValue:e.state.formData.iconPath,"onUpdate:modelValue":n[6]||(n[6]=t=>e.state.formData.iconPath=t),placeholder:e.$t("\u8BF7\u8F93\u5165\u56FE\u6807\u5730\u5740")},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue"])]),_:1},8,["label"])):c("",!0),r(v,{label:e.$t("\u56FE\u6807\u9884\u89C8")},{default:d(()=>[a("div",Fe,[e.showIconPreview?(l(),u($,{key:0},[e.state.formData.iconType==="network"?(l(),u("img",{key:0,src:e.state.formData.iconPath,alt:"icon",width:"24",height:"24"},null,8,_e)):c("",!0),e.state.formData.iconType==="api"?(l(),u("img",{key:1,src:e.tempIconLink,alt:"icon",width:"24",height:"24"},null,8,Te)):c("",!0),e.state.formData.iconType==="text"?(l(),u("div",Ce,s(e.state.formData.name.slice(0,1)),1)):c("",!0)],64)):(l(),u("div",Be))])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}var Ne=j(ee,[["render",Ve],["__scopeId","data-v-20649a42"]]);export{Ne as default};
